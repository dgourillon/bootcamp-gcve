




VEN_NAME=global-ven
PROJECT_ID=$(gcloud config get-value project)
PROJECT_NUMBER=$(gcloud projects list --filter="$PROJECT_ID" --format="value(PROJECT_NUMBER)")
GCVE_NETWORK_NAME=gcve-network

gcloud vmware network-peerings create peering-vpc \
    --project=$PROJECT_ID \
    --peer-network=$GCVE_NETWORK_NAME \
    --peer-network-type="STANDARD" \
    --vmware-engine-network=$VEN_NAME 

PSA_PROJECT_ID=$(gcloud compute networks peerings list --format=json --filter="name=gcve-network" | grep -o 'projects/.*/servicenetworking' | awk -F '/' '{print $2}')

gcloud vmware network-peerings create peering-psa \
    --project=$PROJECT_ID \
    --peer-network="servicenetworking" \
    --peer-project=$PSA_PROJECT_ID \
    --peer-network-type="PRIVATE_SERVICES_ACCESS" \
    --vmware-engine-network=$VEN_NAME 